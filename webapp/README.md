# NoJira: No Meetings, No Standups, Just Problem Solving.

## Install

```bash
yarn install
```

## Development

```bash
yarn dev
```

## Build

```bash
yarn build
```

## GraphQL Code Generation

The project uses an automated GraphQL code generation system to create type-safe operations and custom hooks. Here's how it works:

### Directory Structure

Operations are organized by type and resource:

```
src/documents/
├── comments/
│   ├── mutation/
│   │   ├── add-comment.ts
│   │   └── update-comment.ts
│   └── query/
│       └── get-comment.ts
└── problems/
    ├── mutation/
    │   ├── add-problem.ts
    │   └── update-problem.ts
    └── query/
        └── query-problem.ts
```

### Automatic Operation Generation

The `operations.gen.js` script automatically generates all GraphQL operations based on your schema. You don't need to manually write any GraphQL operations.

1. **Generated Structure**: Operations are automatically organized:

   - Queries in `src/documents/<resource>/query/`
   - Mutations in `src/documents/<resource>/mutation/`

2. **Smart Generation**: The script:
   - Creates proper query/mutation operations
   - Handles variable naming and conflicts
   - Automatically includes required fields in queries/mutations based on schema
   - Creates index files for easy imports

Example of an auto-generated operation:

```typescript
// Auto-generated by operations.gen.js
import { gql } from '@apollo/client';

export const QUERY_PROBLEM = gql`
  query QueryProblem {
    queryProblem {
      id
      title
      status
      # Other fields automatically included based on schema
    }
  }
`;
```

### Code Generation

**Generate Code**: The process involves two steps:

```bash
# 1. Generate GraphQL operations
yarn generate:operations

# 2. Generate types and validate operations
yarn codegen
```

The first command generates all GraphQL operations from the schema, while the second command generates TypeScript types and validates the generated operations for correctness.

### Using Custom Hooks

1. **Queries with `useAppQuery`**:

The `useAppQuery` hook provides a simplified interface for GraphQL queries with automatic response extraction:

```typescript
import { useAppQuery } from '@/hooks/useAppQuery';
import { QUERY_PROBLEM } from '@/documents/problems/query';
import { Problem } from '@/types/graphql.gen';

// Basic query
const { data, loading, error, refetch, isEmpty } = useAppQuery<Problem[]>(
  QUERY_PROBLEM
);

// Query with variables
const { data } = useAppQuery<Problem, { id: string }>(
  QUERY_PROBLEM,
  { id: problemId }
);

// Query with options
const { data, refetch } = useAppQuery<Problem[]>(
  QUERY_PROBLEM,
  undefined,
  { skip: !isReady } // Skip query if not ready
);

// Handle loading and error states
if (loading) return <Loading />;
if (error) return <Error message={error.message} />;
if (isEmpty) return <Empty />;

return <ProblemList problems={data} />;
```

2. **Mutations with `useAppMutation`**:

The `useAppMutation` hook simplifies mutations with built-in error handling and response transformation:

```typescript
import { useAppMutation } from '@/hooks/useAppMutation';
import { UPDATE_PROBLEM } from '@/documents/problems/mutation';
import { Problem, UpdateProblemInput } from '@/types/graphql.gen';

// Basic mutation
const { execute, loading, error } = useAppMutation<
  Problem,
  { input: UpdateProblemInput }
>(UPDATE_PROBLEM);

// Mutation with callbacks
const { execute } = useAppMutation<Problem, { input: UpdateProblemInput }>(
  UPDATE_PROBLEM,
  {
    onCompleted: (problem) => {
      // Handle successful update
      toast.success(`Updated problem: ${problem.title}`);
    },
    onError: (error) => {
      // Handle error
      toast.error(`Failed to update: ${error.message}`);
    },
  }
);

// Execute mutation
try {
  const updatedProblem = await execute({
    input: {
      filter: { id: [problemId] },
      set: { title: newTitle },
    },
  });

  // updatedProblem contains the transformed response
  console.log('Updated:', updatedProblem.title);
} catch (error) {
  console.error('Mutation failed:', error);
}
```
